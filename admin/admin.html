<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Admin ‚Äì Participants</title>

<style>
  body {
    font-family: Arial, sans-serif;
    background: #f4f4f4;
    margin: 0;
    padding: 0;
  }

  .container {
    max-width: 900px;
    margin: 40px auto;
    background: #fff;
    padding: 30px;
    border-radius: 8px;
  }

  h1 {
    text-align: center;
    margin-bottom: 10px;
  }

  .top-bar {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 20px;
    gap: 10px;
  }

  .top-bar input {
    padding: 10px;
    font-size: 16px;
    width: 60%;
  }

  .counter {
    font-size: 18px;
    font-weight: bold;
  }

  .card {
    border: 1px solid #ddd;
    border-radius: 6px;
    padding: 15px;
    margin-bottom: 15px;
    background: #fafafa;
  }

  .winner {
    border: 2px solid gold;
    background: #fff7cc;
  }

  .btn {
    margin-top: 10px;
    padding: 8px 14px;
    font-size: 14px;
    cursor: pointer;
  }
</style>
</head>

<body>

<div class="container">
  <h1>Participants</h1>

  <div class="top-bar">
    <input type="text" id="search" placeholder="Search by phone number">
    <div class="counter">Total: <span id="total">0</span></div>
  </div>

  <div id="list">Loading...</div>
</div>

<script>
const SCRIPT_URL ="https://script.google.com/macros/s/AKfycbztxoIyAW2HLdUlUys3YkxfHGe4U_tswDUC31nI1ttnrwxqO7mg70VyWqe9hE7qyaynEA/exec";

let participants = [];

fetch(SCRIPT_URL + "?action=getParticipants")
  .then(res => res.json())
  .then(data => {
    participants = data;
    document.getElementById("total").textContent = data.length;
    render(data);
  });

function render(data) {
  const list = document.getElementById("list");
  list.innerHTML = "";

  if (!data.length) {
    list.innerHTML = "No participants found.";
    return;
  }

  data.forEach((p, i) => {
    const div = document.createElement("div");
    div.className = "card";
    div.innerHTML = `
      <div><b>#${i + 1}</b></div>
      <div><b>Name:</b> ${p.Name}</div>
      <div><b>Phone:</b> ${p.Phone}</div>
      <div><b>Date:</b> ${p.Date}</div>
      <button class="btn" onclick="markWinner(this)">üèÜ Mark winner</button>
    `;
    list.appendChild(div);
  });
}

function markWinner(btn) {
  document
    .querySelectorAll(".winner")
    .forEach(el => el.classList.remove("winner"));

  btn.parentElement.classList.add("winner");
}

document.getElementById("search").addEventListener("input", e => {
  const val = e.target.value.trim();
  const filtered = participants.filter(p =>
    p.Phone.includes(val)
  );
  render(filtered);
});
</script>

</body>
</html>
